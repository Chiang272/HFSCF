hellow
#INFO: **** input file is /home/chiang.272/HFSCF/test/test.py ****
import unittest
import numpy as np
import math
import time

import pyscf.gto
import pyscf.scf
import pyscf.mcscf
import pyscf.fci
import pyscf.mp

#import prism_beta.interface as interface
#import prism_beta.qd_nevpt as qd_nevpt
import basis_set_exchange as bse
#import prism_beta.integrals as integrals

import HFSCF.HF as HF

import sys
from scipy import constants
from pyscf.tools import molden
from pyscf.mcscf import dmet_cas
import csv

print("hellow")

np.set_printoptions(linewidth=150, edgeitems=10, suppress=True)


# SCF cycle:

#theta = np.pi/3
#x = 1.178 * np.cos(theta)
#y = 1.178 * np.sin(theta)

mol = pyscf.gto.Mole()
mol.verbose = 4
mol.atom =[ 
[ 'N',  (0, 0, 0)],
[ 'N',  ( 1.1, 0, 0)],
[ 'O',  ( 2.2, 0, 0)]  #0.774292095
]
#mol.basis = bse.get_basis('ano-rcc',uncontract_general=True, uncontract_segmented=True, uncontract_spdf=True,elements=['Hg','H'],fmt='nwchem',header=False)
mol.basis = 'STO-3g'  #'6-31g**' #'def2tzvp' #'cc-pvdz' #'STO-3G' # 'def2tzvp'


mol.symmetry = False
mol.spin = 0
#mol.unit = 'B' 
mol.max_memory =  10000
mol.charge = 0
mol.build()

print("What type?")
print(type(mol))

HF.kernel(mol)
print("done")

# Run RHF computation
mf = pyscf.scf.RHF(mol) #.x2c()
#mf.xc = "bp86"
mf.conv_tol = 1e-12
#mf.chkfile = "mf4.chk"
ehf = mf.scf()
mf.analyze()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='asccbc-nc206140.asc.ohio-state.edu', release='4.18.0-553.56.1.el8_10.x86_64', version='#1 SMP Mon Jun 2 12:33:13 EDT 2025', machine='x86_64')  Threads 24
Python 3.9.19 (main, May  6 2024, 19:43:03) 
[GCC 11.2.0]
numpy 1.26.4  scipy 1.12.0  h5py 3.11.0
Date: Tue Jun 24 14:12:45 2025
PySCF version 2.6.2
PySCF path  /home/chiang.272/.conda/envs/pyscf_bse/lib/python3.9/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 22
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 N      1.100000000000   0.000000000000   0.000000000000 AA    2.078698737022   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 O      2.200000000000   0.000000000000   0.000000000000 AA    4.157397474043   0.000000000000   0.000000000000 Bohr   0.0

nuclear repulsion = 63.9823355021455
number of shells = 9
number of NR pGTOs = 45
number of NR cGTOs = 15
basis = STO-3g
ecp = {}
CPU time:         0.85
What type?
<class 'pyscf.gto.mole.Mole'>
runing HFSCF...
Basis set: STO-3g
number of atoms: 3
number of electrons: 22
computing nuclear repulsion energy...
Enn= 63.982335502145446
Construct the S^(-1/2) matrix.
Construct initial density matrix.
SCF interation...
count ||||  delta_energy  ||  delta_D
0|||100||8.294349176716764
1|||-336.1171687270056||7.316474762730791
2|||-5.938086885403635||3.0320972422292773
3|||-0.9681405915881385||2.7542093861097534
4|||-0.3357425753030725||2.973821449807911
5|||0.9880886916017744||3.106828250080639
6|||1.2072991683859016||4.289866390598447
7|||2.097624739263466||4.718014967201512
8|||1.161887303191122||4.968213730158363
9|||-0.1960018749894914||5.097131276938409
10|||0.653585871830785||5.10576168197768
11|||-0.5978013519449519||5.1150901892124025
12|||0.6256042114518152||5.115394958946473
13|||-0.6225200144690461||5.116013041488002
14|||0.6242185147120267||5.116022141471582
15|||-0.6240417871167097||5.116062369887649
16|||0.6241467678582353||5.116062539632385
17|||-0.6241363232794868||5.116065124450127
18|||0.6241428473887254||5.116065119300027
19|||-0.6241422165046231||5.116065283985843
20|||0.6241426232390381||5.116065283039895
21|||-0.6241425845831827||5.116065293476424
22|||0.6241426099951468||5.11606529339243
23|||-0.6241426076050232||5.116065294051574
24|||0.624142609195161||5.116065294045319
25|||-0.6241426090466291||5.11606529408687
26|||0.6241426091461335||5.116065294086436
27|||-0.6241426091366975||5.116065294089037
28|||0.624142609143064||5.116065294089025
29|||-0.6241426091423534||5.116065294089182
30|||0.6241426091427229||5.116065294089174
31|||-0.6241426091429503||5.116065294089197
32|||0.6241426091429503||5.116065294089183
33|||-0.6241426091429219||5.116065294089194
34|||0.6241426091428934||5.1160652940891795
35|||-0.6241426091427513||5.1160652940891485
36|||0.6241426091427229||5.116065294089171
37|||-0.6241426091426945||5.116065294089192
38|||0.6241426091426945||5.116065294089197
39|||-0.6241426091425524||5.116065294089198
40|||0.6241426091426376||5.116065294089167
41|||-0.6241426091429219||5.116065294089164
42|||0.6241426091429219||5.116065294089188
43|||-0.6241426091426661||5.116065294089206
44|||0.6241426091426376||5.116065294089206
45|||-0.6241426091427229||5.1160652940891795
46|||0.6241426091426376||5.116065294089175
47|||-0.6241426091426661||5.1160652940891715
48|||0.6241426091425808||5.116065294089177
49|||-0.6241426091426945||5.11606529408919
50|||0.6241426091427229||5.116065294089173
51|||-0.6241426091426945||5.116065294089191
52|||0.6241426091428082||5.116065294089194
53|||-0.6241426091425808||5.1160652940891955
54|||0.6241426091426376||5.11606529408921
55|||-0.6241426091426945||5.116065294089202
56|||0.6241426091426376||5.116065294089189
57|||-0.6241426091427229||5.11606529408918
58|||0.6241426091427797||5.116065294089175
59|||-0.6241426091428366||5.116065294089181
60|||0.6241426091428082||5.116065294089179
61|||-0.6241426091428366||5.116065294089163
62|||0.6241426091429787||5.116065294089181
63|||-0.6241426091429787||5.116065294089162
64|||0.6241426091427229||5.116065294089159
65|||-0.6241426091428082||5.1160652940891875
66|||0.6241426091430355||5.116065294089181
67|||-0.6241426091430355||5.116065294089177
68|||0.6241426091429787||5.116065294089179
69|||-0.6241426091428366||5.116065294089181
70|||0.6241426091426661||5.116065294089184
71|||-0.6241426091425808||5.116065294089173
72|||0.6241426091426376||5.116065294089188
73|||-0.6241426091427797||5.116065294089198
74|||0.6241426091426661||5.116065294089185
75|||-0.6241426091426376||5.116065294089211
76|||0.6241426091428082||5.116065294089184
77|||-0.624142609142865||5.116065294089145
78|||0.6241426091428366||5.116065294089174
79|||-0.6241426091427513||5.116065294089174
80|||0.6241426091427797||5.116065294089173
81|||-0.6241426091428366||5.11606529408919
82|||0.6241426091430355||5.116065294089181
83|||-0.6241426091430071||5.116065294089196
84|||0.6241426091427513||5.116065294089196
85|||-0.6241426091427513||5.116065294089174
86|||0.6241426091428366||5.1160652940891715
87|||-0.6241426091428366||5.116065294089185
88|||0.6241426091428934||5.116065294089198
89|||-0.6241426091427229||5.116065294089183
90|||0.6241426091426945||5.1160652940891875
91|||-0.6241426091428934||5.116065294089204
92|||0.6241426091427797||5.116065294089194
93|||-0.6241426091427229||5.116065294089183
94|||0.6241426091427229||5.1160652940891875
95|||-0.6241426091427797||5.116065294089173
96|||0.6241426091426661||5.116065294089186
97|||-0.6241426091424955||5.116065294089214
98|||0.6241426091426945||5.116065294089197
99|||-0.6241426091427513||5.116065294089168
Total Energy =  -173.43470607942797
done


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-12
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/tmphkuxtqux
max_memory 10000 MB (current use 154 MB)
Set gradient conv threshold to 1e-06
Initial guess from minao.
init E= -182.499838848283
  HOMO = -0.283592925042383  LUMO = 0.223971417339884
cycle= 1 E= -181.037229842932  delta_E= 1.46  |g|= 0.671  |ddm|=  3.1
  HOMO = -0.362678037288581  LUMO = 0.250765064309813
cycle= 2 E= -181.119508856078  delta_E= -0.0823  |g|= 0.31  |ddm|= 1.03
  HOMO = -0.373674407449313  LUMO = 0.283037503014628
cycle= 3 E= -181.141443057831  delta_E= -0.0219  |g|= 0.0583  |ddm|= 0.37
  HOMO = -0.378053912723091  LUMO = 0.287456369132979
cycle= 4 E= -181.142484700456  delta_E= -0.00104  |g|= 0.021  |ddm|= 0.0869
  HOMO = -0.377093988736797  LUMO = 0.288141332879008
cycle= 5 E= -181.142622701948  delta_E= -0.000138  |g|= 0.00404  |ddm|= 0.0383
  HOMO = -0.377031763371911  LUMO = 0.287743475798633
cycle= 6 E= -181.142629506194  delta_E= -6.8e-06  |g|= 0.000652  |ddm|= 0.0109
  HOMO = -0.377061053038919  LUMO = 0.287813416977177
cycle= 7 E= -181.142629656112  delta_E= -1.5e-07  |g|= 3e-05  |ddm|= 0.00169
  HOMO = -0.377058233570202  LUMO = 0.287812177125932
cycle= 8 E= -181.142629656442  delta_E= -3.3e-10  |g|= 3.15e-06  |ddm|= 7.79e-05
  HOMO = -0.377058491041958  LUMO = 0.287813036666901
cycle= 9 E= -181.142629656447  delta_E= -4.95e-12  |g|= 1.01e-06  |ddm|= 8.34e-06
  HOMO = -0.377058570969711  LUMO = 0.287813015283521
cycle= 10 E= -181.142629656447  delta_E= -5.12e-13  |g|= 2.61e-08  |ddm|= 2.63e-06
  HOMO = -0.37705857264647  LUMO = 0.287813014973197
Extra cycle  E= -181.142629656447  delta_E= 1.14e-13  |g|= 6.82e-09  |ddm|= 3.71e-08
converged SCF energy = -181.142629656447
**** SCF Summaries ****
Total Energy =                        -181.142629656447212
Nuclear Repulsion Energy =              63.982335502145453
One-electron Energy =                 -373.750208899757297
Two-electron Energy =                  128.625243741164638
**** MO energy ****
MO #1   energy= -20.4010750171409  occ= 2
MO #2   energy= -15.7484929549551  occ= 2
MO #3   energy= -15.4662212101102  occ= 2
MO #4   energy= -1.62780584379846  occ= 2
MO #5   energy= -1.39695581515111  occ= 2
MO #6   energy= -0.766073504414644 occ= 2
MO #7   energy= -0.766073504414642 occ= 2
MO #8   energy= -0.732534091454936 occ= 2
MO #9   energy= -0.590511618600996 occ= 2
MO #10  energy= -0.377058572646471 occ= 2
MO #11  energy= -0.37705857264647  occ= 2
MO #12  energy= 0.287813014973197  occ= 0
MO #13  energy= 0.287813014973197  occ= 0
MO #14  energy= 0.66350819858524   occ= 0
MO #15  energy= 1.38507799709889   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 N 1s            1.99991
pop of  0 N 2s            1.66136
pop of  0 N 2px           1.18865
pop of  0 N 2py           1.15568
pop of  0 N 2pz           1.15568
pop of  1 N 1s            1.99997
pop of  1 N 2s            1.13366
pop of  1 N 2px           1.11632
pop of  1 N 2py           1.20780
pop of  1 N 2pz           1.20780
pop of  2 O 1s            1.99990
pop of  2 O 2s            1.74142
pop of  2 O 2px           1.15881
pop of  2 O 2py           1.63651
pop of  2 O 2pz           1.63651
 ** Mulliken atomic charges  **
charge of    0N =     -0.16129
charge of    1N =      0.33445
charge of    2O =     -0.17316
Dipole moment(X, Y, Z, Debye):  0.24150, -0.00000, -0.00000
